CREATE ALGORITHM=UNDEFINED DEFINER=`root`@`localhost` SQL SECURITY DEFINER VIEW `churn_analytics` AS select `s`.`contract` AS `Contract`,count(0) AS `total_customers`,sum((case when (`cs`.`Churn` = 'Yes') then 1 else 0 end)) AS `churned_customers`,round(((100.0 * sum((case when (`cs`.`Churn` = 'Yes') then 1 else 0 end))) / count(0)),2) AS `churn_percentage` from ((`customers` `c` left join `subscriptions` `s` on((`c`.`customerID` = `s`.`customerID`))) left join `churn_status` `cs` on((`c`.`customerID` = `cs`.`customerID`))) group by `s`.`contract`;
